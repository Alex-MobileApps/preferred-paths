#!/bin/bash
#SBATCH --job-name=lr
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=1
#SBATCH --ntasks-per-node=1
#SBATCH --time=48:00:00
#SBATCH --mem-per-cpu=4000
#SBATCH --partition=skylake
#SBATCH --gres=gpu:1

module load python/3.8.5
module load pytorch/1.7.1-python-3.8.5
module load scipy/1.6.0-python-3.8.5
module load scikit-learn/0.24.2-python-3.8.5

python3 ./ozstar_train.py --res 219 --subj 0 --epoch 10 --batch 1 --sample 100 --hu 100 --lr 0.1 --save results/train/train_lr/train_lr_r219_su0_b1_sa100_hu100_lr1.pt --nolog
python3 ./ozstar_train.py --res 219 --subj 0 --epoch 10 --batch 1 --sample 100 --hu 100 --lr 0.01 --save results/train/train_lr/train_lr_r219_su0_b1_sa100_hu100_lr01.pt --nolog
python3 ./ozstar_train.py --res 219 --subj 0 --epoch 10 --batch 1 --sample 100 --hu 100 --lr 0.001 --save results/train/train_lr/train_lr_r219_su0_b1_sa100_hu100_lr001.pt --nolog
python3 ./ozstar_train.py --res 219 --subj 0 --epoch 10 --batch 1 --sample 100 --hu 100 --lr 0.0001 --save results/train/train_lr/train_lr_r219_su0_b1_sa100_hu100_lr0001.pt --nolog

python3 ./ozstar_cv.py --res 219 --batch 1 --sample 100 --load results/train/train_lr/train_lr_r219_su0_b1_sa100_hu100_lr1.pt --save results/cv/cv_lr/cv_lr_r219_su0_b1_sa100_hu100_lr1.pt --nolog
python3 ./ozstar_cv.py --res 219 --batch 1 --sample 100 --load results/train/train_lr/train_lr_r219_su0_b1_sa100_hu100_lr01.pt --save results/cv/cv_lr/cv_lr_r219_su0_b1_sa100_hu100_lr01.pt --nolog
python3 ./ozstar_cv.py --res 219 --batch 1 --sample 100 --load results/train/train_lr/train_lr_r219_su0_b1_sa100_hu100_lr001.pt --save results/cv/cv_lr/cv_lr_r219_su0_b1_sa100_hu100_lr001.pt --nolog
python3 ./ozstar_cv.py --res 219 --batch 1 --sample 100 --load results/train/train_lr/train_lr_r219_su0_b1_sa100_hu100_lr0001.pt --save results/cv/cv_lr/cv_lr_r219_su0_b1_sa100_hu100_lr0001.pt --nolog